@model List<PoEBrowser.Models.Essence>

@{
    ViewData["Title"] = "GetEssences";
}

@{
    int totalItems = Model.Count();
}


<div class="container">

    <div class="row mt-1 mb-1">
        <div style="text-align: center; font-size: x-small; width: 100%"><i>Displaying @totalItems Items</i></div>
    </div>

    @{
        var prevItemType = "";
        var itemCount = 0;
        var rowClosed = false;
    }

    @{    
        @:<div class="container">
            @for (int i = 0; i < totalItems; i++)
            {
                if (prevItemType != Model[i].Type)
                {
                    if (!rowClosed)
                    {
                        @:</div>
                        rowClosed = true;
                    }

                    @:<div class="row" style="width: 100%">
                        @:<div class="col-md">
                            <p class="mt-4 mb-1 text-muted"><b>@Model[i].Type</b></p>
                            <hr class="mt-0 mb-1" />
                        @:</div>
                    @:</div>

                    itemCount = 0;
                }

                if (itemCount == 0)
                {
                    @:<div class="row">
                    rowClosed = false;
                }

                @:<div class="col-lg-3 mt-0 pt-0">
                    <img style="max-height: 25px; width: auto" src="@Model[i].ImgSrcString" />
                    <a asp-action="GetEssenceByName" asp-route-name="@Model[i].Name" style="font-size: small">@Model[i].Name</a>
                @:</div>

                if (itemCount == 3)
                {
                    itemCount = 0;
                    rowClosed = true;
                    @:</div>
                }
                else
                {
                    itemCount++;
                }

                prevItemType = Model[i].Type;
            }
        }
@{ 
    // Attempt to alleviate missing start tag errors in IDE due to conditional end tags
    @:</div>
@:</div>
}
